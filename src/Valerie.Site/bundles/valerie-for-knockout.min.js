"valerie for knockout (c) 2013 egrove Ltd. License: MIT (http://www.opensource.org/licenses/mit-license.php)";(function(){typeof valerie=="undefined"&&(valerie={}),valerie=valerie||{},valerie.converters=valerie.converters||{},valerie.rules=valerie.rules||{},valerie.utils=valerie.utils||{}})(),function(){"use strict";var n=valerie.utils;n.asFunction=function(t){return n.isFunction(t)?t:function(){return t}},n.formatString=function(n,t){return(t===undefined||t===null)&&(t={}),n.replace(/\{(\w+)\}/g,function(n,i){var r=t[i];return typeof r=="string"?r:n})},n.isArray=function(n){return{}.toString.call(n)==="[object Array]"},n.isFunction=function(n){return n===undefined||n===null?!1:typeof n=="function"},n.isObject=function(n){return n===null?!1:typeof n=="object"},n.mergeOptions=function(n,t){var r={},i;(n===undefined||n===null)&&(n={}),(t===undefined||t===null)&&(t={});for(i in n)n.hasOwnProperty(i)&&(r[i]=n[i]);for(i in t)t.hasOwnProperty(i)&&(r[i]=t[i]);return r},n.isMissing=function(n){return n===undefined||n===null?!0:n.length===0?!0:!1}}(),function(){"use strict";var n=valerie.converters;n.passThrough={formatter:function(n){return n===undefined||n===null?"":n.toString()},parser:function(n){return n}}}(),function(){"use strict";var n=valerie.rules;n.passThrough={test:function(){return n.successfulTestResult}},n.successfulTestResult={failed:!1,failureMessage:""}}(),function(){"use strict";var n=valerie.converters;n.integer={formatter:function(n){return n===undefined||n===null?"":n.toString()},parser:function(n){if(n===undefined||n===null)return undefined;var t=parseInt(n,10);return isNaN(t)?undefined:t}},n.string={formatter:function(n){return n===undefined||n===null?"":n},parser:function(n){return n===undefined||n===null?undefined:n}}}(),function(){"use strict";var n=valerie.rules,t=valerie.utils;n.Range=function(i,r,u){if(arguments.length<2||arguments.length>3)throw"2 or 3 arguments expected.";this.minimum=t.asFunction(i),this.maximum=t.asFunction(r),this.options=t.mergeOptions(n.Range.defaultOptions,u)},n.Range.defaultOptions={failureMessageFormatForMinimumOnly:"The value must be no less than {minimum}.",failureMessageFormatForMaximumOnly:"The value must be no greater than {maximum}.",failureMessageFormatForRange:"The value must be between {minimum} and {maximum}.",valueFormatter:valerie.converters.passThrough.formatter},n.Range.prototype={test:function(i){var o,e=this.options.failureMessageFormatForRange,u=this.maximum(),f=this.minimum(),s=u!==undefined&&u!==null,h=f!==undefined&&f!==null,c=i!==undefined&&i!==null,r=!0;return!s&&!h?n.successfulTestResult:(c?(s?r=i<=u:e=this.options.failureMessageFormatForMinimumOnly,h?r=r&&i>=f:e=this.options.failureMessageFormatForMaximumOnly):r=!1,r)?n.successfulTestResult:(o=t.formatString(e,{maximum:this.options.valueFormatter(u),minimum:this.options.valueFormatter(f),value:this.options.valueFormatter(i)}),{failed:!0,failureMessage:o})}}}(),function(){var n="__valerie_knockout_state";if(typeof ko=="undefined")throw"KnockoutJS is required. Please reference it before referencing this library.";valerie.knockout={getState:function(t){return t[n]},hasState:function(t){return t.hasOwnProperty(n)},setState:function(t,i){t[n]=i}}}(),function(){"use strict";var i=valerie.converters,n=valerie.knockout,r=valerie.rules,t=valerie.utils;(function(){n.ValidationContext=function(n){this.submissionAttempted=ko.observable(!1),ko.utils.extend(this,n)},n.ValidationContext.defaultContext=new n.ValidationContext,n.ValidationResult=function(n,t){this.failed=n,this.failureMessage=t},n.ValidationResult.success=new n.ValidationResult(!1,""),function(){var u=function(){var t=this.observableOrComputed();return!this.options.required()||!this.options.missingTest(t)?n.ValidationResult.success:{failed:!0,failureMessage:this.options.missingFailureMessage}},f=function(){var n=this.observableOrComputed();return this.options.rule.test(n)},i=function(){var t;return(t=this.binding.result(),t.failed)?t:(t=u.apply(this),t.failed)?t:(t=f.apply(this),t.failed)?t:n.ValidationResult.success},r=function(){var n=i.apply(this);return n.failed},e=function(){var n=i.apply(this);return n.failureMessage},o=function(){var n=i.apply(this);return!n.failed},s=function(){return this.binding.result().failed||this.options.context.submissionAttempted()&&r.apply(this)};n.ValidationState=function(u,f){f=t.mergeOptions(n.ValidationState.defaultOptions,f),f.applicable=t.asFunction(f.applicable),f.required=t.asFunction(f.required),this.options=f,this.binding={active:!1,result:ko.observable(n.ValidationResult.success)},this.observableOrComputed=u,this.failed=ko.computed(r,this,{deferEvaluation:!0}),this.message=ko.computed(e,this,{deferEvaluation:!0}),this.passed=ko.computed(o,this,{deferEvaluation:!0}),this.result=ko.computed(i,this,{deferEvaluation:!0}),this.showMessage=ko.computed(s,this,{deferEvaluation:!0})}}(),n.ValidationState.prototype={applicable:function(n){return n===undefined&&(n=!0),this.options.applicable=t.asFunction(n),this},end:function(){return this.observableOrComputed},required:function(n){return n===undefined&&(n=!0),this.options.required=t.asFunction(n),this}},n.ValidationState.defaultOptions={applicable:t.asFunction(!0),context:n.ValidationContext.defaultContext,converter:i.passThrough,invalidEntryFailureMessage:"The value entered is invalid.",missingFailureMessage:"A value is required.",missingTest:t.isMissing,required:t.asFunction(!1),rule:r.passThrough}})(),function(){var t="validation";ko.observable.fn[t]=ko.computed.fn[t]=function(t){var i=n.getState(this);return i?i:(i=new n.ValidationState(this,t),n.setState(this,i),i)}}()}(),function(){"use strict";var n=valerie.knockout;(function(){var t=function(t,i){var r=n.getState(i);if(r.binding.active){if(r.binding.active=!1,r.binding.result.peek().failed)return;t.value=r.options.converter.formatter(i())}},i=function(t,i,r){var o=ko.utils.stringTrim(i.value),e,u=n.getState(r),f=u.options;if(u.binding.active=!0,o.length===0&&f.required()){u.binding.result(new n.ValidationResult(!0,f.missingFailureMessage));return}if(e=f.converter.parser(o),e===undefined){u.binding.result(new n.ValidationResult(!0,f.invalidEntryFailureMessage));return}u.binding.result(n.ValidationResult.success),r(e)};ko.bindingHandlers.validatedValue={init:function(r,u){var f=u(),e=r.tagName.toLowerCase();if(!(e==="input"&&r.type.toLowerCase()==="text"||e==="textarea"))throw"The 'validatedValue' binding can only be applied to text input and text area elements.";if(!n.hasState(f))throw"The 'validatedValue' binding can only be applied to validatable observables or computeds.";ko.utils.registerEventHandler(r,"blur",function(){t(r,f)}),ko.utils.registerEventHandler(r,"keyup",function(n){i(n,r,f)})},update:function(t,i){var u=i(),r=n.getState(u);r.binding.active||(r.binding.result(n.ValidationResult.success),t.value=r.options.converter.formatter(u()))}}})(),function(){var t=function(t,i,r){var f,u,e=i(),o;n.hasState(e)&&(o=n.getState(e),f=t.style.display!=="none",u=r(o),f!==u)&&(t.style.display=u?"":"none")};ko.bindingHandlers.visibleWhenInvalid={update:function(n,i){t(n,i,function(n){return n.failed()})}},ko.bindingHandlers.visibleWhenValid={update:function(n,i){t(n,i,function(n){return n.passed()})}}}()}(),function(){"use strict";var t=valerie.converters,n=valerie.knockout.ValidationState.prototype,i=valerie.rules;n.between=function(n,t){return this.options.rule=new i.Range(n,t),this},n.integer=function(){return this.options.converter=t.integer,this}}();
//@ sourceMappingURL=valerie-for-knockout.min.js.map