/* valerie - MIT license - (c) egrove Ltd (egrove.co.uk) */
var valerie={};!function(){"use strict";valerie.utils={};var a=valerie.utils;a.asArray=function(b){return a.isArray(b)?b:[b]},a.asFunction=function(b){return a.isFunction(b)?b:function(){return b}},a.isArray=function(a){return"[object Array]"==={}.toString.call(a)},a.isArrayOrObject=function(a){return null===a?!1:"object"==typeof a},a.isFunction=function(a){return null==a?!1:"function"==typeof a},a.isMissing=function(b){return null==b?!0:a.isString(b)?0===b.length:!1},a.isObject=function(b){return null===b?!1:a.isArray(b)?!1:"object"==typeof b},a.isString=function(a){return"[object String]"==={}.toString.call(a)},a.mergeOptions=function(b,c){var d,e,f={};null==b&&(b={}),null==c&&(c={});for(d in b)b.hasOwnProperty(d)&&(e=b[d],a.isArray(e)&&(e=e.slice(0)),f[d]=e);for(d in c)c.hasOwnProperty(d)&&(f[d]=c[d]);return f}}(),function(){"use strict";valerie.formatting={};var a=valerie.formatting;a.addThousandsSeparator=function(a,b,c){var d=a.toString().split(c),e=d[0];return e=e.replace(/\B(?=(\d{3})+(?!\d))/g,b),d[0]=e,d.join(c)},a.pad=function(a,b,c){return a=a.toString(),a.length>=c?a:new Array(c+1-a.length).join(b)+a},a.replacePlaceholders=function(a,b){return null==b&&(b={}),a.replace(/\{(\w+)\}/g,function(a,c){var d=b[c];return null==d?a:d.toString()})}}(),function(){"use strict";valerie.dom={};var a=/\s+/g,b=/^\s+|\s+$/g,c=valerie.dom;c.classNamesDictionaryToString=function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&a[b]&&c.push(b);return c.sort(),c.join(" ")},c.classNamesStringToDictionary=function(c){var d,e,f={};if(null==c)return f;if(c=c.replace(b,""),0===c.length)return f;for(d=c.split(a),e=0;e<d.length;e++)f[d[e]]=!0;return f},c.setElementVisibility=function(a,b){var c="none"!==a.style.display;c!==b&&(a.style.display=b?"":"none")}}(),function(){"use strict";valerie.koExtras={},valerie.koExtras.isolatedBindingHandler=function(a,b){var c=1===arguments.length?function(){}:a;return b=2===arguments.length?b:a,{init:function(a,d,e,f,g){c(a,d,e,f,g),ko.computed({read:function(){b(a,d,e,f,g)},disposeWhenNodeIsRemoved:a})}}},valerie.koExtras.pausableComputed=function(a,b,c,d){var e,f,g;return f=null==d?ko.observable(!1):ko.utils.isSubscribable(d)?d:ko.observable(d),g=ko.computed(function(){return f()?e:a.call(b)},b,c),g.paused=ko.computed({read:function(){return f()},write:function(a){a&&(a=!0),a!==f()&&(a&&(e=g()),f(a))}}),g.refresh=function(){f()&&(f(!1),e=g(),f(!0))},g}}(),function(){"use strict";valerie.converters={},valerie.converters.passThrough={format:function(a){return null==a?"":a.toString()},parse:function(a){return a}}}(),function(){"use strict";var a={failed:{},passed:{},pending:{}};valerie.ValidationResult=function(b,c){null==c&&(c=""),this.state=b,this.message=c,this.failed=b===a.failed,this.passed=b===a.passed,this.pending=b===a.pending},valerie.ValidationResult.states=a,valerie.ValidationResult.passedInstance=new valerie.ValidationResult(a.passed),valerie.ValidationResult.pendingInstance=new valerie.ValidationResult(a.pending),valerie.ValidationResult.createFailedResult=function(b){return new valerie.ValidationResult(a.failed,b)}}(),function(){"use strict";valerie.validationState={};var a="validation",b=valerie.utils;valerie.validationState.findIn=function(a,c,d,e){1 in arguments||(c=!0),2 in arguments||(d=!1),3 in arguments||(e=[]);var f,g,h;for(f in a)if(a.hasOwnProperty(f)){if(h=a[f],null==h)continue;if(g=valerie.validationState.getFor(h),ko.isObservable(h)&&(h=h.peek()),b.isFunction(h))continue;g&&(g instanceof valerie.PropertyValidationState?e.push(g):c&&e.push(g)),d&&b.isArrayOrObject(h)&&valerie.validationState.findIn(h,c,!0,e)}return e},valerie.validationState.getFor=function(b){return null==b?null:b.hasOwnProperty(a)?b[a]():null},valerie.validationState.has=function(b){return null==b?!1:b.hasOwnProperty(a)},valerie.validationState.setFor=function(b,c){b[a]=function(){return c}}}(),function(){"use strict";var a={deferEvaluation:!0},b=valerie.utils,c=valerie.ValidationResult.passedInstance,d=valerie.ValidationResult.pendingInstance,e=ko.observable,f=ko.computed,g=function(){return this.result().failed},h=function(){var a,b,c,d=[],e=this.validationStates();for(c=0;c<e.length;c++)a=e[c],a.isApplicable()&&(b=a.result(),b.failed&&d.push(a));return d},i=function(){return this.result().message},j=function(){return this.result().passed},k=function(){return this.result().pending},l=function(){var a,b,c=[],d=this.validationStates();for(b=0;b<d.length;b++)a=d[b],a.isApplicable()&&a.result().pending&&c.push(a);return c},m=function(){return this.failedStates().length>0?valerie.ValidationResult.createFailedResult(this.settings.failureMessageFormat):this.pendingStates().length>0?d:c},n=function(){var a,b=this.validationStates();for(a=0;a<b.length;a++)if(b[a].touched())return!0;return!1},o=function(a){var b,c,d=this.validationStates();for(b=0;b<d.length;b++)c=d[b],c.isApplicable()&&c.touched(a)};valerie.ModelValidationState=function(c,d){d=b.mergeOptions(valerie.ModelValidationState.defaultOptions,d),d.applicable=b.asFunction(d.applicable),d.name=b.asFunction(d.name),this.failed=f(g,this,a),this.failedStates=f(h,this,a),this.message=f(i,this,a),this.model=c,this.passed=f(j,this,a),this.pending=f(k,this,a),this.pendingStates=f(l,this,a),this.result=valerie.koExtras.pausableComputed(m,this,a,d.paused),this.paused=this.result.paused,this.refresh=this.result.refresh,this.settings=d,this.getName=function(){return this.settings.name()},this.isApplicable=function(){return this.settings.applicable()},this.summary=e([]),this.touched=f({read:n,write:o,deferEvaluation:!0,owner:this}),this.validationStates=ko.observableArray()},valerie.ModelValidationState.prototype={addValidationStates:function(a){return a=b.asArray(a),this.validationStates.push.apply(this.validationStates,a),this},applicable:function(a){return null==a&&(a=!0),this.settings.applicable=b.asFunction(a),this},clearSummary:function(a){var b,c,d;if(this.summary([]),a)for(b=this.validationStates(),d=0;d<b.length;d++)c=b[d],c.clearSummary&&c.clearSummary(!0);return this},end:function(){return this.model},includeInSummary:function(){return this.settings.excludeFromSummary=!1,this},name:function(a){return this.settings.name=b.asFunction(a),this},removeValidationStates:function(a){return a=b.asArray(a),this.validationStates.removeAll(a),this},startValidatingSubModel:function(a){return this.validationStates.push(a.validation()),this},stopValidatingSubModel:function(a){return this.validationStates.remove(a.validation()),this},updateSummary:function(a){var b,c,d=this.failedStates(),e=[];for(c=0;c<d.length;c++)b=d[c],b.settings.excludeFromSummary||e.push({name:b.getName(),message:b.message()});if(this.summary(e),a)for(d=this.validationStates(),c=0;c<d.length;c++)b=d[c],b.isApplicable()&&b.updateSummary&&b.updateSummary(!0);return this},validateAll:function(){var a=valerie.validationState.findIn(this.model,!0,!0);return this.addValidationStates(a),this},validateAllProperties:function(){var a=valerie.validationState.findIn(this.model,!1,!0);return this.addValidationStates(a),this},validateChildProperties:function(){var a=valerie.validationState.findIn(this.model,!1,!1);return this.addValidationStates(a),this},validateChildPropertiesAndSubModels:function(){var a=valerie.validationState.findIn(this.model,!0,!1);return this.addValidationStates(a),this}},valerie.ModelValidationState.defaultOptions={applicable:b.asFunction(!0),excludeFromSummary:!0,failureMessageFormat:"",name:b.asFunction("(?)"),paused:null},valerie.validatableModel=function(a,b){var c=new valerie.ModelValidationState(a,b);return valerie.validationState.setFor(a,c),c}}(),function(){"use strict";var a={deferEvaluation:!0},b=valerie.utils,c=valerie.formatting,d=valerie.koExtras,e=ko.observable,f=ko.computed,g=valerie.ValidationResult.passedInstance,h=function(a){var b=a.observableOrComputed(),c=a.settings.missingTest(b),d=a.settings.required();return c&&d?-1:c&&!d?0:1},i=function(a){var b,c,d,e=a.observableOrComputed(),f=a.settings.rules;for(d=0;d<f.length;d++)if(b=f[d],c=b.test(e),c.failed||c.pending)return c;return g},j=function(){return this.result().failed},k=function(){var a=this.result().message;return a=c.replacePlaceholders(a,{name:this.settings.name()})},l=function(){return this.result().passed},m=function(){return this.result().pending},n=function(){var a,b;return b=this.boundEntry.result(),b.failed?b:(a=h(this),-1===a?valerie.ValidationResult.createFailedResult(this.settings.missingFailureMessage):0===a?b:i(this))},o=function(){return this.settings.applicable()?this.touched()&&this.result().failed:!1};valerie.PropertyValidationState=function(c,h){h=b.mergeOptions(valerie.PropertyValidationState.defaultOptions,h),h.applicable=b.asFunction(h.applicable),h.name=b.asFunction(h.name),h.required=b.asFunction(h.required),this.boundEntry={focused:e(!1),result:e(g),textualInput:!1},this.failed=f(j,this,a),this.message=d.pausableComputed(k,this,a),this.passed=f(l,this,a),this.observableOrComputed=c,this.pending=f(m,this,a),this.result=f(n,this,a),this.settings=h,this.getName=function(){return this.settings.name()},this.isApplicable=function(){return this.settings.applicable()},this.showMessage=d.pausableComputed(o,this,a),this.touched=e(!1)},valerie.PropertyValidationState.prototype={addRule:function(a){return this.settings.rules.push(a),this},applicable:function(a){return null==a&&(a=!0),this.settings.applicable=b.asFunction(a),this},end:function(){var a,b,c=this.settings,d=c.valueFormat,e=c.rules;for(a=0;a<e.length;a++)b=e[a].settings,b.valueFormat=d;return this.observableOrComputed},entryFormat:function(a){return this.settings.entryFormat=a,this},excludeFromSummary:function(){return this.settings.excludeFromSummary=!0,this},name:function(a){return this.settings.name=b.asFunction(a),this},required:function(a){return null==a&&(a=!0),this.settings.required=b.asFunction(a),this},valueFormat:function(a){return this.settings.valueFormat=a,this}},valerie.PropertyValidationState.defaultOptions={applicable:b.asFunction(!0),converter:valerie.converters.passThrough,entryFormat:null,excludeFromSummary:!1,invalidEntryFailureMessage:"",missingFailureMessage:"",missingTest:b.isMissing,name:b.asFunction(),required:b.asFunction(!1),rules:[],valueFormat:null},valerie.validatableProperty=function(a,b){if(!ko.isSubscribable(a))throw"Only observables or computeds can be made validatable properties.";var c=new valerie.PropertyValidationState(a,b);return valerie.validationState.setFor(a,c),c}}(),function(){"use strict";ko.computed.fn.validate=function(a){return valerie.validatableProperty(this,a)}}(),function(){"use strict";ko.observable.fn.validate=function(a){return valerie.validatableProperty(this,a)},ko.observableArray.fn.validateAsModel=function(a){return valerie.validatableModel(this,a)},ko.observableArray.fn.propertyValidationState=function(a){return new valerie.PropertyValidationState(this,a)}}(),function(){"use strict";var a=ko.bindingHandlers.checked,b=ko.bindingHandlers.value;valerie.koBindingsHelper={setTextContent:function(a,b){ko.bindingHandlers.text.update(a,function(){return b})},useOriginalBindingHandlers:function(){ko.bindingHandlers.checked=a,ko.bindingHandlers.value=b},useValidatingBindingHandlers:function(){ko.bindingHandlers.checked=ko.bindingHandlers.validatedChecked,ko.bindingHandlers.value=ko.bindingHandlers.validatedValue}}}(),function(){"use strict";var a=valerie.ValidationResult.passedInstance,b=valerie.utils,c=valerie.dom,d=c.setElementVisibility,e=valerie.converters,f=valerie.validationState.getFor,g=ko.bindingHandlers,h=valerie.koBindingsHelper,i=ko.utils.registerEventHandler,j=valerie.koExtras.isolatedBindingHandler,k=/^(\s|\u00A0)+|(\s|\u00A0)+$/g;!function(){var c=g.checked,d=g.value,e=function(a,b){var c=f(b);c.touched(!0),c.boundEntry.focused(!1),c.message.paused(!1),c.showMessage.paused(!1)},h=function(a,b){var c,d=f(b);d.boundEntry.result.peek().failed||(c=b.peek(),a.value=d.settings.converter.format(c,d.settings.entryFormat))},j=function(a,b){var c=f(b);c.boundEntry.focused(!0),c.message.paused(!0),c.showMessage.paused(!0)},l=function(b,c){var d,e=(b.value||"").replace(k,""),g=f(c),h=g.settings,i=a;0===e.length?(c(null),h.required()&&(i=valerie.ValidationResult.createFailedResult(h.missingFailureMessage))):(d=h.converter.parse(e),c(d),null==d&&(i=valerie.ValidationResult.createFailedResult(h.invalidEntryFailureMessage))),g.boundEntry.result(i)},m=function(b,c,d){var e=b();c.boundEntry.focused.peek()||(c.boundEntry.result(a),d.value=c.settings.converter.format(e,c.settings.entryFormat))};g.validatedChecked={init:function(a,d,g,h,j){var k=d(),l=f(k);c.init(a,d,g,h,j),l&&(i(a,"blur",function(){e(a,k)}),null==l.settings.name()&&(l.settings.name=b.asFunction(a.name)))},update:c.update},g.validatedValue={init:function(a,c,g,k,n){var o,p,q=c(),r=f(q);return r?(null==r.settings.name()&&(r.settings.name=b.asFunction(a.name)),i(a,"blur",function(){e(a,q)}),o=a.tagName.toLowerCase(),(p="input"===o&&"text"===a.type.toLowerCase()||"textarea"===o)?(r.boundEntry.textualInput=!0,i(a,"blur",function(){h(a,q)}),i(a,"focus",function(){j(a,q)}),i(a,"keyup",function(){l(a,q)}),ko.computed({read:function(){m(q,r,a)},disposeWhenNodeIsRemoved:a}),void 0):(d.init(a,c,g,k,n),void 0)):(d.init(a,c,g,k,n),void 0)},update:function(a,b,c,e,g){var h=b(),i=f(h);i&&i.boundEntry.textualInput||d.update(a,b,c,e,g)}}}(),function(){var a=function(a,b,c,d,e){var g,h=d(),i=c();i===!0&&(i=h.value||h.checked||h.validatedValue||h.validatedChecked||e),g=f(i),g&&a(g,i,h)};g.disabledWhenNotValid=j(function(b,c,d,e){var f=function(a){b.disabled=!a.passed()};a(f,b,c,d,e)}),g.disabledWhenTouchedAndNotValid=j(function(b,c,d,e){var f=function(a){b.disabled=a.touched()&&!a.passed()};a(f,b,c,d,e)}),g.enabledWhenApplicable=j(function(b,c,d,e){var f=function(a){b.disabled=!a.settings.applicable()};a(f,b,c,d,e)}),g.formattedText=j(function(a,b,c){var d,g=c(),i=b(),j=ko.utils.unwrapObservable(i),k=f(i),l=e.passThrough.format;k&&(l=k.settings.converter.format,d=k.settings.valueFormat),l=g.formatter||l,null==d&&(d=g.valueFormat);var m=l(j,d);h.setTextContent(a,m)}),g.validationCss=j(function(b,d,e,f){var h=function(a){var d=g.validationCss.classNames,e=b.className,f=c.classNamesStringToDictionary(e),h=a.failed(),i=!1,j=a.passed(),k=a.pending(),l=a.touched(),m=!l;a.boundEntry&&a.boundEntry.focused()&&(i=!0),f[d.failed]=h,f[d.focused]=i,f[d.passed]=j,f[d.pending]=k,f[d.touched]=l,f[d.untouched]=m,b.className=c.classNamesDictionaryToString(f)};a(h,b,d,e,f)}),g.validationCss.classNames={failed:"failed",focused:"focused",passed:"passed",pending:"pending",touched:"touched",untouched:"untouched"},g.validationMessage=j(function(b,c,e,f){var g=function(a){d(b,a.showMessage());var c=a.message();h.setTextContent(b,c)};a(g,b,c,e,f)}),g.validationMessageText=j(function(b,c,d,e){var f=function(a){var c=a.message();h.setTextContent(b,c)};a(f,b,c,d,e)}),g.visibleWhenApplicable=j(function(b,c,e,f){var g=function(a){d(b,a.isApplicable())};a(g,b,c,e,f)}),g.visibleWhenFocused=j(function(b,c,e,f){var g=function(a){d(b,a.focused())};a(g,b,c,e,f)}),g.visibleWhenInvalid=j(function(b,c,e,f){var g=function(a){d(b,a.failed())};a(g,b,c,e,f)}),g.visibleWhenSummaryNotEmpty=j(function(b,c,e,f){var g=function(a){d(b,a.summary().length>0)};a(g,b,c,e,f)}),g.visibleWhenTouched=j(function(b,c,e,f){var g=function(a){d(b,a.touched())};a(g,b,c,e,f)}),g.visibleWhenUntouched=j(function(b,c,e,f){var g=function(a){d(b,!a.touched())};a(g,b,c,e,f)}),g.visibleWhenValid=j(function(b,c,e,f){var g=function(a){d(b,a.passed())};a(g,b,c,e,f)})}()}(),function(){"use strict";var a=valerie.formatting,b=function(a,b){var c=b.indexOf("C")>-1,d=b.indexOf(",")>-1,e=b.indexOf("."),f=0;return e===b.length-1?f=null:e>-1&&(f="c"===b.charAt(e+1)?a.settings.currencyMinorUnitPlaces:Number(b.substr(e+1))),{includeCurrencySign:c,includeThousandsSeparator:d,numberOfDecimalPlaces:f}};valerie.NumericHelper=function(){},valerie.NumericHelper.prototype={init:function(a,b,c,d){var e="\\d+(\\"+b+"\\d{3})*",f="(\\"+c+")?"+e,g=f+"(\\"+a+"\\d{"+d+"})?",h=e+"(\\"+a+"\\d+)?";return this.settings={decimalSeparator:a,thousandsSeparator:b,currencySign:c,currencyMinorUnitPlaces:d},this.expressions={currencyMajor:new RegExp("^"+f+"$"),currencyMajorMinor:new RegExp("^"+g+"$"),"float":new RegExp("^"+h+"$"),integer:new RegExp("^"+e+"$")},this},addThousandsSeparator:function(b){var c=this.settings;return a.addThousandsSeparator(b,c.thousandsSeparator,c.decimalSeparator)},format:function(a,c){if(null==a)return"";null==c&&(c="");var d=this.settings,e=b(this,c),f=e.numberOfDecimalPlaces,g=0>a;return g&&(a=-a),a=null!=f?a.toFixed(f):a.toString(),a=a.replace(".",d.decimalSeparator),e.includeThousandsSeparator&&(a=this.addThousandsSeparator(a)),(g?"-":"")+(e.includeCurrencySign?d.currencySign:"")+a},isCurrencyMajor:function(a){return this.expressions.currencyMajor.test(a)},isCurrencyMajorMinor:function(a){return this.expressions.currencyMajorMinor.test(a)},isFloat:function(a){return this.expressions.float.test(a)},isInteger:function(a){return this.expressions.integer.test(a)},parse:function(a){return a=this.unformat(a),Number(a)},unformat:function(a){var b=this.settings;return a=a.replace(b.currencySign,""),a=a.replace(b.thousandsSeparator,""),a=a.replace(b.decimalSeparator,".")}}}(),function(){"use strict";var a=new valerie.NumericHelper,b=/^(\d\d?)(?:\-|\/|\.)(\d\d?)(?:\-|\/|\.)(\d\d\d\d)$/,c=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i,d=valerie.formatting.pad,e=valerie.converters=valerie.converters||{};e.date={format:function(a){if(null==a)return"";var b,c;return e.date.monthBeforeDate?(b=a.getMonth()+1,c=a.getDate()):(b=a.getDate(),c=a.getMonth()+1),d(b,"0",2)+"/"+d(c,"0",2)+"/"+a.getFullYear()},parse:function(a){if(null==a)return null;var c=a.match(b);if(null==c)return null;var d,f,g=parseInt(c[1],10),h=parseInt(c[2],10),i=parseInt(c[3],10);return e.date.monthBeforeDate?(d=h,f=g):(d=g,f=h),f--,a=new Date(i,f,d),a.getFullYear()!==i||a.getMonth()!==f||a.getDate()!==d?null:a},monthBeforeDate:!1},e.defaultNumericHelper=a,e.currencyMajor={format:function(a,b){return e.currency.numericHelper.format(a,b)},parse:function(a){var b=e.currency.numericHelper;return b.isCurrencyMajor(a)?b.parse(a):null}},e.currencyMajorMinor={format:function(a,b){return e.currency.numericHelper.format(a,b)},parse:function(a){var b=e.currency.numericHelper;return b.isCurrencyMajorMinor(a)?b.parse(a):null}},e.currency={numericHelper:a},e.email={format:function(a){return null==a?"":a},parse:function(a){return null==a?null:c.test(a)?a.toLowerCase():null}},e.float={format:function(a,b){return e.float.numericHelper.format(a,b)},parse:function(a){var b=e.float.numericHelper;return b.isFloat(a)?b.parse(a):null}},e.float.numericHelper=a,e.integer={format:function(a,b){return e.integer.numericHelper.format(a,b)},parse:function(a){var b=e.integer.numericHelper;return b.isInteger(a)?b.parse(a):null}},e.integer.numericHelper=a,e.number={format:function(a){return null==a?"":a.toString()},parse:function(a){return null==a?null:(a=Number(a),isNaN(a)?null:a)}}}(),function(){"use strict";valerie.rules={};var a=valerie.utils,b=valerie.formatting,c=valerie.rules,d=valerie.ValidationResult.passedInstance;c.ArrayLength=function(b,d,e){if(arguments.length<2)throw"At least 2 arguments are expected.";return e=a.mergeOptions(c.ArrayLength.defaultOptions,e),new c.Length(b,d,e)},c.ArrayLength.defaultOptions={failureMessageFormat:"",failureMessageFormatForMinimumOnly:"",failureMessageFormatForMaximumOnly:"",valueFormat:null,valueFormatter:valerie.converters.passThrough.format},c.During=function(b,d,e){if(arguments.length<2)throw"At least 2 arguments are expected.";return e=a.mergeOptions(c.During.defaultOptions,e),new c.Range(b,d,e)},c.During.defaultOptions={failureMessageFormat:"",failureMessageFormatForMinimumOnly:"",failureMessageFormatForMaximumOnly:"",valueFormat:null,valueFormatter:valerie.converters.passThrough.format},c.Expression=function(b,d){return this.settings=a.mergeOptions(c.Expression.defaultOptions,d),a.isFunction(b)?(this.expression=b,void 0):(a.isString(b)&&(b=new RegExp(b)),this.expression=function(){return b},void 0)},c.Expression.defaultOptions={failureMessageFormat:"",valueFormat:null,valueFormatter:valerie.converters.passThrough.format},c.Expression.prototype={test:function(c){var e,f;return null!=c&&(f=this.expression(),a.isString(f)&&(f=new RegExp(f)),f.test(c))?d:(e=b.replacePlaceholders(this.settings.failureMessageFormat,{value:this.settings.valueFormatter(c,this.settings.valueFormat)}),valerie.ValidationResult.createFailedResult(e))}},c.Length=function(b,d,e){if(arguments.length<2)throw"At least 2 arguments are expected.";e=a.mergeOptions(c.Length.defaultOptions,e);var f=new c.Range(b,d,e);this.test=function(a){var b;return null!=a&&a.hasOwnProperty("length")&&(b=a.length),f.test(b)},this.settings=f.settings},c.Length.defaultOptions={failureMessageFormat:"",failureMessageFormatForMinimumOnly:"",failureMessageFormatForMaximumOnly:"",valueFormat:null,valueFormatter:valerie.converters.passThrough.format},c.Matches=function(b,d){return d=a.mergeOptions(c.Matches.defaultOptions,d),new c.OneOf([b],d)},c.Matches.defaultOptions={failureMessageFormat:"",formatter:valerie.converters.passThrough.format,valueFormat:null},c.NoneOf=function(b,d){this.forbiddenValues=a.asFunction(b),this.settings=a.mergeOptions(c.NoneOf.defaultOptions,d)},c.NoneOf.defaultOptions={failureMessageFormat:"",formatter:valerie.converters.passThrough.format,valueFormat:null},c.NoneOf.prototype={test:function(a){var c,e,f=this.forbiddenValues();for(e=0;e<f.length;e++)if(a===f[e])return c=b.replacePlaceholders(this.settings.failureMessageFormat,{value:this.settings.valueFormatter(a,this.settings.valueFormat)}),valerie.ValidationResult.createFailedResult(c);return d}},c.Not=function(b,d){return d=a.mergeOptions(c.Not.defaultOptions,d),new c.NoneOf([b],d)},c.Not.defaultOptions={failureMessageFormat:"",valueFormat:null,valueFormatter:valerie.converters.passThrough.format},c.OneOf=function(b,d){this.permittedValues=a.asFunction(b),this.settings=a.mergeOptions(c.OneOf.defaultOptions,d)},c.OneOf.defaultOptions={failureMessageFormat:"",valueFormat:null,valueFormatter:valerie.converters.passThrough.format},c.OneOf.prototype={test:function(a){var c,e,f=this.permittedValues();for(e=0;e<f.length;e++)if(a===f[e])return d;return c=b.replacePlaceholders(this.settings.failureMessageFormat,{value:this.settings.valueFormatter(a,this.settings.valueFormat)}),valerie.ValidationResult.createFailedResult(c)}},c.Range=function(b,d,e){if(arguments.length<2||arguments.length>3)throw"At least 2 arguments are expected.";this.minimum=a.asFunction(b),this.maximum=a.asFunction(d),this.settings=a.mergeOptions(c.Range.defaultOptions,e)},c.Range.defaultOptions={failureMessageFormat:"",failureMessageFormatForMinimumOnly:"",failureMessageFormatForMaximumOnly:"",valueFormat:null,valueFormatter:valerie.converters.passThrough.format},c.Range.prototype={test:function(a){var c,e=this.settings.failureMessageFormat,f=this.maximum(),g=this.minimum(),h=null!=f,i=null!=g,j=null!=a,k=!0;return h||i?(j?(h?k=f>=a:e=this.settings.failureMessageFormatForMinimumOnly,i?k=k&&a>=g:e=this.settings.failureMessageFormatForMaximumOnly):k=!1,k?d:(c=b.replacePlaceholders(e,{maximum:this.settings.valueFormatter(f,this.settings.valueFormat),minimum:this.settings.valueFormatter(g,this.settings.valueFormat),value:this.settings.valueFormatter(a,this.settings.valueFormat)}),valerie.ValidationResult.createFailedResult(c))):d}},c.StringLength=function(b,d,e){if(arguments.length<2)throw"At least 2 arguments are expected.";return e=a.mergeOptions(c.StringLength.defaultOptions,e),new c.Length(b,d,e)},c.StringLength.defaultOptions={failureMessageFormat:"",failureMessageFormatForMinimumOnly:"",failureMessageFormatForMaximumOnly:"",valueFormat:null,valueFormatter:valerie.converters.passThrough.format}}(),function(){"use strict";var a=valerie.utils,b=valerie.converters,c=valerie.PropertyValidationState.prototype;c.currencyMajor=function(c){return c=a.mergeOptions(this.currencyMajor.defaultOptions,c),this.settings=a.mergeOptions(this.settings,c),this.settings.converter=b.currencyMajor,this},c.currencyMajor.defaultOptions={entryFormat:null,valueFormat:"C,"},c.currencyMajorMinor=function(c){return c=a.mergeOptions(this.currencyMajorMinor.defaultOptions,c),this.settings=a.mergeOptions(this.settings,c),this.settings.converter=b.currencyMajorMinor,this},c.currencyMajorMinor.defaultOptions={entryFormat:".c",valueFormat:"C,.c"},c.date=function(){return this.settings.converter=b.date,this},c.email=function(){return this.settings.converter=b.email,this},c.float=function(c){return c=a.mergeOptions(this.float.defaultOptions,c),this.settings=a.mergeOptions(this.settings,c),this.settings.converter=b.float,this},c.float.defaultOptions={entryFormat:null,valueFormat:",."},c.integer=function(c){return c=a.mergeOptions(this.integer.defaultOptions,c),this.settings=a.mergeOptions(this.settings,c),this.settings.converter=b.integer,this},c.integer.defaultOptions={entryFormat:null,valueFormat:","},c.number=function(){return this.settings.converter=b.number,this},c.string=function(){return this.settings.converter=b.passThrough,this}}(),function(){"use strict";var a=valerie.PropertyValidationState.prototype,b=valerie.rules;a.during=function(a,c,d){return this.addRule(new b.During(a,c,d))},a.earliest=function(a,c){return this.addRule(new b.During(a,null,c))},a.expression=function(a,c){return this.addRule(new b.Expression(a,c))},a.latest=function(a,c){return this.addRule(new b.During(null,a,c))},a.lengthBetween=function(a,c,d){return this.addRule(new b.StringLength(a,c,d))},a.matches=function(a,c){return this.addRule(new b.Matches(a,c))},a.maximum=function(a,c){return this.addRule(new b.Range(null,a,c))},a.maximumNumberOfItems=function(a,c){return this.addRule(new b.ArrayLength(null,a,c))},a.maximumLength=function(a,c){return this.addRule(new b.StringLength(null,a,c))},a.minimum=function(a,c){return this.addRule(new b.Range(a,null,c))},a.minimumNumberOfItems=function(a,c){return this.addRule(new b.ArrayLength(a,null,c))},a.minimumLength=function(a,c){return this.addRule(new b.StringLength(a,null,c))},a.noneOf=function(a,c){return this.addRule(new b.NoneOf(a,c))},a.not=function(a,c){return this.addRule(new b.Not(a,c))},a.numberOfItems=function(a,c,d){return this.addRule(new b.ArrayLength(a,c,d))},a.oneOf=function(a,c){return this.addRule(new b.OneOf(a,c))},a.range=function(a,c,d){return this.addRule(new b.Range(a,c,d))},a.rule=function(a){return this.addRule({settings:{},test:function(b){return a(b)}})},a.ruleMessage=function(a){var b,c=this.settings.rules,d=c.length-1;return d>=0&&(b=c[d],b.settings.failureMessageFormat=a,null!=b.settings.failureMessageFormatForMaximumOnly&&(b.settings.failureMessageFormatForMaximumOnly=a),null!=b.settings.failureMessageFormatForMinimumOnly&&(b.settings.failureMessageFormatForMinimumOnly=a)),this}}();